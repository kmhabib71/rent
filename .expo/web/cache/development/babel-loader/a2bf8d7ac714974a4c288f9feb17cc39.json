{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport styles from \"./styles\";\nimport { withAuthenticator } from \"aws-amplify-react-native\";\nimport { Auth, Storage, API, graphqlOperation } from \"aws-amplify\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport { colors } from \"../../modal/color\";\nimport { Octicons } from \"@expo/vector-icons\";\nimport { MaterialCommunityIcons } from \"@expo/vector-icons\";\nimport { MaterialIcons } from \"@expo/vector-icons\";\nimport { FontAwesome } from \"@expo/vector-icons\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useRoute } from \"@react-navigation/native\";\nimport \"react-native-get-random-values\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { createListing } from \"../../graphql/mutations\";\nimport HeaderForDesktop from \"../../components/headerForDesktop\";\nimport MenuDetailsForDesktop from \"../../components/menuDetailsForDesktop\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Listing = function Listing() {\n  var windowWidth = Number(Dimensions.get(\"window\").width);\n  var navigation = useNavigation();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      imageData = _useState2[0],\n      setImageData = _useState2[1];\n\n  var _useState3 = useState({\n    catID: 0,\n    catName: \"Category\"\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      category = _useState4[0],\n      setCategory = _useState4[1];\n\n  var _useState5 = useState({\n    locID: 0,\n    locName: \"Location\"\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      Location = _useState6[0],\n      setLocation = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      title = _useState8[0],\n      setTitle = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      description = _useState10[0],\n      setDescription = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      rentValue = _useState12[0],\n      setRentValue = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      _useState14 = _slicedToArray(_useState13, 2),\n      userID = _useState14[0],\n      setUserID = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      userEmail = _useState16[0],\n      setUserEmail = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      postSuccess = _useState18[0],\n      setPostSuccess = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      postProcessing = _useState20[0],\n      setPostProcessing = _useState20[1];\n\n  var pickImage = function pickImage() {\n    var result;\n    return _regeneratorRuntime.async(function pickImage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [4, 3],\n              quality: 1,\n              allowsMultipleSelection: true\n            }));\n\n          case 2:\n            result = _context.sent;\n\n            if (!result.cancelled) {\n              setImageData(result.selected);\n            }\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    if (postSuccess !== \"\") {\n      setPostProcessing(false);\n      Alert.alert(\"Success\", postSuccess, [{\n        text: \"Ok\",\n        onPress: function onPress() {\n          return navigation.navigate(\"Home\", {\n            screen: \"Explore\"\n          });\n        }\n      }]);\n    }\n  }, [postSuccess]);\n  Auth.currentAuthenticatedUser().then(function (user) {\n    setUserID(user.attributes.sub);\n    setUserEmail(user.attributes.email);\n  }).catch(function (err) {\n    console.log(err);\n    throw err;\n  });\n  var route = useRoute();\n  useEffect(function () {\n    if (!route.params) {\n      console.log(\"There is no data in route\");\n    } else {\n      if (route.params.imageData !== undefined) {\n        setImageData(route.params.imageData);\n      } else if (route.params.catID !== undefined) {\n        setCategory(route.params);\n      } else if (route.params.locID !== undefined) {\n        setLocation(route.params);\n      }\n    }\n  });\n  var imageAllUrl = [];\n\n  var storeToDB = function storeToDB() {\n    return _regeneratorRuntime.async(function storeToDB$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            setPostProcessing(true);\n            imageData && imageData.map(function _callee(compnent, index) {\n              var imageUrl, response, blob, contentType, extension, key, urlParts, _extension, postData;\n\n              return _regeneratorRuntime.async(function _callee$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      imageUrl = compnent.uri;\n                      _context2.next = 3;\n                      return _regeneratorRuntime.awrap(fetch(imageUrl));\n\n                    case 3:\n                      response = _context2.sent;\n                      _context2.next = 6;\n                      return _regeneratorRuntime.awrap(response.blob());\n\n                    case 6:\n                      blob = _context2.sent;\n\n                      if (Platform.OS === \"web\") {\n                        contentType = blob.type;\n                        extension = contentType.split(\"/\")[1];\n                        key = uuidv4() + \".\" + extension;\n                      } else {\n                        urlParts = imageUrl.split(\".\");\n                        _extension = urlParts[urlParts.length - 1];\n                        key = uuidv4() + \".\" + _extension;\n                      }\n\n                      imageAllUrl.push({\n                        imageUri: key\n                      });\n                      _context2.next = 11;\n                      return _regeneratorRuntime.awrap(Storage.put(key, blob));\n\n                    case 11:\n                      if (!(imageData.length == index + 1)) {\n                        _context2.next = 17;\n                        break;\n                      }\n\n                      postData = {\n                        title: title,\n                        categoryName: category.catName,\n                        categoryID: category.catID,\n                        description: description,\n                        images: JSON.stringify(imageAllUrl),\n                        locationID: Location.locID,\n                        locationName: Location.locName,\n                        owner: userEmail,\n                        rentValue: rentValue,\n                        userID: userID,\n                        commonID: \"1\"\n                      };\n                      _context2.next = 15;\n                      return _regeneratorRuntime.awrap(API.graphql({\n                        query: createListing,\n                        variables: {\n                          input: postData\n                        },\n                        authMode: \"AMAZON_COGNITO_USER_POOLS\"\n                      }));\n\n                    case 15:\n                      setPostProcessing(false);\n                      setPostSuccess(\"Your adv have successfully published.\");\n\n                    case 17:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            });\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _useState21 = useState(false),\n      _useState22 = _slicedToArray(_useState21, 2),\n      menuToggle = _useState22[0],\n      setMenuToggle = _useState22[1];\n\n  return _jsxs(View, {\n    style: {\n      flex: 1,\n      width: \"100%\",\n      alignItems: \"center\"\n    },\n    children: [_jsx(HeaderForDesktop, {\n      setMenuToggle: setMenuToggle,\n      menuToggle: menuToggle\n    }), _jsxs(ScrollView, {\n      style: {\n        margin: 10,\n        width: windowWidth > 800 ? \"80%\" : \"100%\",\n        padding: windowWidth > 800 ? 50 : 10\n      },\n      children: [_jsxs(View, {\n        children: [_jsx(Text, {\n          style: {\n            marginTop: 10\n          },\n          children: \"Upload images [Max 5 photos]\"\n        }), _jsx(Pressable, {\n          style: {\n            backgroundColor: colors.white,\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            marginVertical: 20,\n            height: 150,\n            width: 150,\n            borderWidth: 1,\n            borderStyle: \"dashed\",\n            borderRadius: 30\n          },\n          onPress: function onPress() {\n            if (Platform.OS === \"web\") {\n              pickImage();\n            } else {\n              navigation.navigate(\"SelectPhoto\");\n            }\n          },\n          children: _jsx(AntDesign, {\n            name: \"pluscircle\",\n            size: 24,\n            color: \"black\"\n          })\n        }), _jsx(View, {\n          children: _jsx(ScrollView, {\n            horizontal: true,\n            children: imageData && imageData.map(function (component, index) {\n              return _jsx(Image, {\n                source: {\n                  uri: component.uri\n                },\n                style: {\n                  height: 100,\n                  width: 100,\n                  marginBottom: 20,\n                  marginTop: -5,\n                  marginRight: 5\n                }\n              }, component.id);\n            })\n          })\n        })]\n      }), _jsxs(Pressable, {\n        style: styles.catStyle,\n        onPress: function onPress() {\n          navigation.navigate(\"SelectCategory\");\n        },\n        children: [_jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          },\n          children: [_jsx(Octicons, {\n            name: \"settings\",\n            size: 24,\n            color: \"black\"\n          }), _jsx(Text, {\n            style: {\n              fontSize: 16,\n              color: colors.secondary,\n              marginLeft: 5\n            },\n            children: category.catName\n          })]\n        }), _jsx(AntDesign, {\n          name: \"right\",\n          size: 22,\n          color: colors.secondary\n        })]\n      }), _jsxs(Pressable, {\n        onPress: function onPress() {\n          navigation.navigate(\"SelectLocation\");\n        },\n        style: styles.catStyle,\n        children: [_jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          },\n          children: [_jsx(MaterialCommunityIcons, {\n            name: \"map-marker\",\n            size: 24,\n            color: colors.secondary\n          }), _jsx(Text, {\n            style: {\n              fontSize: 16,\n              color: colors.secondary,\n              marginLeft: 5\n            },\n            children: Location.locName\n          })]\n        }), _jsx(AntDesign, {\n          name: \"right\",\n          size: 22,\n          color: colors.secondary\n        })]\n      }), _jsxs(View, {\n        style: styles.inputTextStyle,\n        children: [_jsx(MaterialIcons, {\n          name: \"title\",\n          size: 24,\n          color: colors.secondary\n        }), _jsx(TextInput, {\n          placeholder: \"Adv Title\",\n          style: {\n            width: \"100%\"\n          },\n          onChangeText: function onChangeText(text) {\n            return setTitle(text);\n          }\n        })]\n      }), _jsxs(View, {\n        style: styles.inputTextStyle,\n        children: [_jsx(MaterialIcons, {\n          name: \"description\",\n          size: 24,\n          color: colors.secondary\n        }), _jsx(TextInput, {\n          placeholder: \"Write a description\",\n          style: {\n            marginLeft: 5,\n            width: \"100%\"\n          },\n          onChangeText: function onChangeText(text) {\n            return setDescription(text);\n          },\n          multiline: true,\n          numberOfLines: 3\n        })]\n      }), _jsxs(View, {\n        style: [styles.inputTextStyle, {\n          width: \"50%\"\n        }],\n        children: [_jsx(FontAwesome, {\n          name: \"dollar\",\n          size: 24,\n          color: colors.secondary\n        }), _jsx(TextInput, {\n          placeholder: \"Add a value\",\n          style: {\n            marginLeft: 5,\n            width: \"100%\"\n          },\n          onChangeText: function onChangeText(text) {\n            return setRentValue(text);\n          },\n          keyboardType: \"numeric\"\n        })]\n      }), _jsx(Pressable, {\n        onPress: function onPress() {\n          return storeToDB();\n        },\n        android_ripple: {\n          color: \"grey\"\n        },\n        style: {\n          margin: 10,\n          borderRadius: 30,\n          backgroundColor: colors.secondary,\n          alignItems: \"center\",\n          paddingLeft: 20,\n          elevation: 5\n        },\n        children: _jsx(Text, {\n          style: {\n            color: colors.white,\n            paddingVertical: 12,\n            fontSize: 14.5,\n            fontWeight: \"bold\"\n          },\n          children: postProcessing ? \"Processing...\" : \"POST ADV\"\n        })\n      })]\n    }), _jsx(MenuDetailsForDesktop, {\n      menuToggle: menuToggle,\n      top: 59,\n      right: \"9.3%\"\n    })]\n  });\n};\n\nexport default withAuthenticator(Listing);","map":{"version":3,"sources":["C:/Users/Km Habib/Documents/GitHub/Rent_Project/rent/src/screens/Listing/index.js"],"names":["React","useState","useEffect","styles","withAuthenticator","Auth","Storage","API","graphqlOperation","AntDesign","colors","Octicons","MaterialCommunityIcons","MaterialIcons","FontAwesome","useNavigation","useRoute","v4","uuidv4","createListing","HeaderForDesktop","MenuDetailsForDesktop","ImagePicker","Listing","windowWidth","Number","Dimensions","get","width","navigation","imageData","setImageData","catID","catName","category","setCategory","locID","locName","Location","setLocation","title","setTitle","description","setDescription","rentValue","setRentValue","userID","setUserID","userEmail","setUserEmail","postSuccess","setPostSuccess","postProcessing","setPostProcessing","pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","allowsMultipleSelection","result","cancelled","selected","Alert","alert","text","onPress","navigate","screen","currentAuthenticatedUser","then","user","attributes","sub","email","catch","err","console","log","route","params","undefined","imageAllUrl","storeToDB","map","compnent","index","imageUrl","uri","fetch","response","blob","Platform","OS","contentType","type","extension","split","key","urlParts","length","push","imageUri","put","postData","categoryName","categoryID","images","JSON","stringify","locationID","locationName","owner","commonID","graphql","query","variables","input","authMode","menuToggle","setMenuToggle","flex","alignItems","margin","padding","marginTop","backgroundColor","white","display","justifyContent","marginVertical","height","borderWidth","borderStyle","borderRadius","component","marginBottom","marginRight","id","catStyle","flexDirection","fontSize","color","secondary","marginLeft","inputTextStyle","paddingLeft","elevation","paddingVertical","fontWeight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  StyleSheet,\n  SafeAreaView,\n  Platform,\n  View,\n  Text,\n  Pressable,\n  TextInput,\n  Image,\n  ScrollView,\n  Alert,\n  Dimensions,\n} from \"react-native\";\nimport styles from \"./styles\";\nimport { withAuthenticator } from \"aws-amplify-react-native\";\nimport { Auth, Storage, API, graphqlOperation } from \"aws-amplify\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport { colors } from \"../../modal/color\";\nimport { Octicons } from \"@expo/vector-icons\";\nimport { MaterialCommunityIcons } from \"@expo/vector-icons\";\nimport { MaterialIcons } from \"@expo/vector-icons\";\nimport { FontAwesome } from \"@expo/vector-icons\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useRoute } from \"@react-navigation/native\";\nimport \"react-native-get-random-values\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { createListing } from \"../../graphql/mutations\";\nimport HeaderForDesktop from \"../../components/headerForDesktop\";\nimport MenuDetailsForDesktop from \"../../components/menuDetailsForDesktop\";\nimport * as ImagePicker from \"expo-image-picker\";\nconst Listing = () => {\n  const windowWidth = Number(Dimensions.get(\"window\").width);\n  const navigation = useNavigation();\n  const [imageData, setImageData] = useState([]);\n  const [category, setCategory] = useState({ catID: 0, catName: \"Category\" });\n  const [Location, setLocation] = useState({ locID: 0, locName: \"Location\" });\n  const [title, setTitle] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [rentValue, setRentValue] = useState(\"\");\n  const [userID, setUserID] = useState(\"\");\n  const [userEmail, setUserEmail] = useState(\"\");\n  const [postSuccess, setPostSuccess] = useState(\"\");\n  const [postProcessing, setPostProcessing] = useState(false);\n  // const [image, setImage] = useState(null);\n\n  const pickImage = async () => {\n    // No permissions request is necessary for launching the image library\n    let result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\n      allowsEditing: true,\n      aspect: [4, 3],\n      quality: 1,\n      allowsMultipleSelection: true,\n    });\n\n    // console.log(result);\n\n    if (!result.cancelled) {\n      setImageData(result.selected);\n    }\n  };\n  useEffect(() => {\n    if (postSuccess !== \"\") {\n      setPostProcessing(false);\n      Alert.alert(\"Success\", postSuccess, [\n        {\n          text: \"Ok\",\n          onPress: () => navigation.navigate(\"Home\", { screen: \"Explore\" }),\n        },\n      ]);\n    }\n  }, [postSuccess]);\n  Auth.currentAuthenticatedUser()\n    .then((user) => {\n      // console.log(\"user id is: \", user.attributes.sub);\n      setUserID(user.attributes.sub);\n      setUserEmail(user.attributes.email);\n    })\n    .catch((err) => {\n      console.log(err);\n      throw err;\n    });\n\n  const route = useRoute();\n  useEffect(() => {\n    if (!route.params) {\n      console.log(\"There is no data in route\");\n    } else {\n      if (route.params.imageData !== undefined) {\n        // console.log(route.params.imageData);\n        setImageData(route.params.imageData);\n      } else if (route.params.catID !== undefined) {\n        setCategory(route.params);\n      } else if (route.params.locID !== undefined) {\n        setLocation(route.params);\n      }\n    }\n  });\n\n  const imageAllUrl = [];\n  const storeToDB = async () => {\n    setPostProcessing(true);\n    imageData &&\n      imageData.map(async (compnent, index) => {\n        const imageUrl = compnent.uri;\n        const response = await fetch(imageUrl);\n        const blob = await response.blob();\n        if (Platform.OS === \"web\") {\n          const contentType = blob.type;\n          const extension = contentType.split(\"/\")[1];\n          var key = `${uuidv4()}.${extension}`;\n        } else {\n          const urlParts = imageUrl.split(\".\");\n          const extension = urlParts[urlParts.length - 1];\n          var key = `${uuidv4()}.${extension}`;\n        }\n\n        imageAllUrl.push({ imageUri: key });\n        await Storage.put(key, blob);\n\n        if (imageData.length == index + 1) {\n          const postData = {\n            title: title,\n            categoryName: category.catName,\n            categoryID: category.catID,\n            description: description,\n            images: JSON.stringify(imageAllUrl),\n            locationID: Location.locID,\n            locationName: Location.locName,\n            owner: userEmail,\n            rentValue: rentValue,\n            userID: userID,\n            commonID: \"1\",\n          };\n\n          await API.graphql({\n            query: createListing,\n            variables: { input: postData },\n            authMode: \"AMAZON_COGNITO_USER_POOLS\",\n          });\n\n          setPostProcessing(false);\n          setPostSuccess(\"Your adv have successfully published.\");\n        }\n      });\n  };\n  // Auth.signOut();\n  const [menuToggle, setMenuToggle] = useState(false);\n  return (\n    <View style={{ flex: 1, width: \"100%\", alignItems: \"center\" }}>\n      <HeaderForDesktop setMenuToggle={setMenuToggle} menuToggle={menuToggle} />\n      <ScrollView\n        style={{\n          margin: 10,\n          width: windowWidth > 800 ? \"80%\" : \"100%\",\n          padding: windowWidth > 800 ? 50 : 10,\n        }}>\n        <View>\n          <Text style={{ marginTop: 10 }}>Upload images [Max 5 photos]</Text>\n          <Pressable\n            style={{\n              backgroundColor: colors.white,\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              marginVertical: 20,\n              height: 150,\n              width: 150,\n              borderWidth: 1,\n              borderStyle: \"dashed\",\n              borderRadius: 30,\n            }}\n            onPress={() => {\n              if (Platform.OS === \"web\") {\n                pickImage();\n              } else {\n                navigation.navigate(\"SelectPhoto\");\n              }\n            }}>\n            <AntDesign name=\"pluscircle\" size={24} color=\"black\" />\n          </Pressable>\n          <View>\n            <ScrollView horizontal={true}>\n              {imageData &&\n                imageData.map((component, index) => (\n                  <Image\n                    key={component.id}\n                    source={{ uri: component.uri }}\n                    style={{\n                      height: 100,\n                      width: 100,\n                      marginBottom: 20,\n                      marginTop: -5,\n                      marginRight: 5,\n                    }}\n                  />\n                ))}\n            </ScrollView>\n          </View>\n        </View>\n        <Pressable\n          style={styles.catStyle}\n          onPress={() => {\n            navigation.navigate(\"SelectCategory\");\n          }}>\n          <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\n            <Octicons name=\"settings\" size={24} color=\"black\" />\n            <Text\n              style={{ fontSize: 16, color: colors.secondary, marginLeft: 5 }}>\n              {category.catName}\n            </Text>\n          </View>\n          <AntDesign name=\"right\" size={22} color={colors.secondary} />\n        </Pressable>\n        <Pressable\n          onPress={() => {\n            navigation.navigate(\"SelectLocation\");\n          }}\n          style={styles.catStyle}>\n          <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\n            <MaterialCommunityIcons\n              name=\"map-marker\"\n              size={24}\n              color={colors.secondary}\n            />\n            <Text\n              style={{ fontSize: 16, color: colors.secondary, marginLeft: 5 }}>\n              {Location.locName}\n            </Text>\n          </View>\n          <AntDesign name=\"right\" size={22} color={colors.secondary} />\n        </Pressable>\n\n        <View style={styles.inputTextStyle}>\n          <MaterialIcons name=\"title\" size={24} color={colors.secondary} />\n          <TextInput\n            placeholder=\"Adv Title\"\n            style={{ width: \"100%\" }}\n            onChangeText={(text) => setTitle(text)}\n          />\n        </View>\n        <View style={styles.inputTextStyle}>\n          <MaterialIcons\n            name=\"description\"\n            size={24}\n            color={colors.secondary}\n          />\n          <TextInput\n            placeholder=\"Write a description\"\n            style={{ marginLeft: 5, width: \"100%\" }}\n            onChangeText={(text) => setDescription(text)}\n            multiline={true}\n            numberOfLines={3}\n          />\n        </View>\n        <View style={[styles.inputTextStyle, { width: \"50%\" }]}>\n          <FontAwesome name=\"dollar\" size={24} color={colors.secondary} />\n          <TextInput\n            placeholder=\"Add a value\"\n            style={{ marginLeft: 5, width: \"100%\" }}\n            onChangeText={(text) => setRentValue(text)}\n            keyboardType=\"numeric\"\n          />\n        </View>\n        <Pressable\n          onPress={() => storeToDB()}\n          android_ripple={{ color: \"grey\" }}\n          style={{\n            margin: 10,\n            borderRadius: 30,\n            backgroundColor: colors.secondary,\n            alignItems: \"center\",\n            paddingLeft: 20,\n            // marginTop: 150,\n            elevation: 5,\n          }}>\n          <Text\n            style={{\n              color: colors.white,\n              paddingVertical: 12,\n              fontSize: 14.5,\n              fontWeight: \"bold\",\n            }}>\n            {postProcessing ? \"Processing...\" : \"POST ADV\"}\n          </Text>\n        </Pressable>\n      </ScrollView>\n      <MenuDetailsForDesktop menuToggle={menuToggle} top={59} right={\"9.3%\"} />\n    </View>\n  );\n};\n\nexport default withAuthenticator(Listing);\n"]},"metadata":{},"sourceType":"module"}