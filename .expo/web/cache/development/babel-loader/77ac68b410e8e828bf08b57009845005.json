{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport styles from \"./styles\";\nimport { withAuthenticator } from \"aws-amplify-react-native\";\nimport { Auth, Storage, API, graphqlOperation } from \"aws-amplify\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport { colors } from \"../../modal/color\";\nimport { Octicons } from \"@expo/vector-icons\";\nimport { MaterialCommunityIcons } from \"@expo/vector-icons\";\nimport { MaterialIcons } from \"@expo/vector-icons\";\nimport { FontAwesome } from \"@expo/vector-icons\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useRoute } from \"@react-navigation/native\";\nimport \"react-native-get-random-values\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { createListing } from \"../../graphql/mutations\";\nimport HeaderForDesktop from \"../../components/headerForDesktop\";\nimport MenuDetailsForDesktop from \"../../components/menuDetailsForDesktop\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Listing = function Listing() {\n  var navigation = useNavigation();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      imageData = _useState2[0],\n      setImageData = _useState2[1];\n\n  var _useState3 = useState({\n    catID: 0,\n    catName: \"Category\"\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      category = _useState4[0],\n      setCategory = _useState4[1];\n\n  var _useState5 = useState({\n    locID: 0,\n    locName: \"Location\"\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      Location = _useState6[0],\n      setLocation = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      title = _useState8[0],\n      setTitle = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      description = _useState10[0],\n      setDescription = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      rentValue = _useState12[0],\n      setRentValue = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      _useState14 = _slicedToArray(_useState13, 2),\n      userID = _useState14[0],\n      setUserID = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      userEmail = _useState16[0],\n      setUserEmail = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      postSuccess = _useState18[0],\n      setPostSuccess = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      postProcessing = _useState20[0],\n      setPostProcessing = _useState20[1];\n\n  var _useState21 = useState(null),\n      _useState22 = _slicedToArray(_useState21, 2),\n      image = _useState22[0],\n      setImage = _useState22[1];\n\n  var pickImage = function pickImage() {\n    var result;\n    return _regeneratorRuntime.async(function pickImage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [4, 3],\n              quality: 1,\n              allowsMultipleSelection: true\n            }));\n\n          case 2:\n            result = _context.sent;\n            console.log(\"expo images: \", result);\n\n            if (!result.cancelled) {\n              console.log(result.selected[0].uri);\n            }\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    if (postSuccess !== \"\") {\n      setPostProcessing(false);\n      Alert.alert(\"Success\", postSuccess, [{\n        text: \"Ok\",\n        onPress: function onPress() {\n          return navigation.navigate(\"Home\", {\n            screen: \"Explore\"\n          });\n        }\n      }]);\n    }\n  }, [postSuccess]);\n  Auth.currentAuthenticatedUser().then(function (user) {\n    console.log(\"user id is: \", user.attributes.sub);\n    setUserID(user.attributes.sub);\n    setUserEmail(user.attributes.email);\n  }).catch(function (err) {\n    console.log(err);\n    throw err;\n  });\n  var route = useRoute();\n  useEffect(function () {\n    if (!route.params) {\n      console.log(\"There is no data in route\");\n    } else {\n      if (route.params.imageData !== undefined) {\n        setImageData(route.params.imageData);\n      } else if (route.params.catID !== undefined) {\n        setCategory(route.params);\n      } else if (route.params.locID !== undefined) {\n        setLocation(route.params);\n      }\n    }\n  });\n  var imageAllUrl = [];\n\n  var storeToDB = function storeToDB() {\n    return _regeneratorRuntime.async(function storeToDB$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            setPostProcessing(true);\n            imageData && imageData.map(function _callee(compnent, index) {\n              var imageUrl, response, blob, urlParts, extension, key, postData;\n              return _regeneratorRuntime.async(function _callee$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      imageUrl = compnent.uri;\n                      _context2.next = 3;\n                      return _regeneratorRuntime.awrap(fetch(imageUrl));\n\n                    case 3:\n                      response = _context2.sent;\n                      _context2.next = 6;\n                      return _regeneratorRuntime.awrap(response.blob());\n\n                    case 6:\n                      blob = _context2.sent;\n                      console.log(\"image blob is: \", JSON.stringify(response));\n                      urlParts = imageUrl.split(\".\");\n                      extension = urlParts[urlParts.length - 1];\n                      key = uuidv4() + \".\" + extension;\n                      imageAllUrl.push({\n                        imageUri: key\n                      });\n\n                      if (imageData.length == index + 1) {\n                        postData = {\n                          title: title,\n                          categoryName: category.catName,\n                          categoryID: category.catID,\n                          description: description,\n                          images: JSON.stringify(imageAllUrl),\n                          locationID: Location.locID,\n                          locationName: Location.locName,\n                          owner: userEmail,\n                          rentValue: rentValue,\n                          userID: userID,\n                          commonID: \"1\"\n                        };\n                      }\n\n                    case 13:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            });\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var _useState23 = useState(false),\n      _useState24 = _slicedToArray(_useState23, 2),\n      menuToggle = _useState24[0],\n      setMenuToggle = _useState24[1];\n\n  return _jsxs(View, {\n    style: {\n      flex: 1,\n      width: \"100%\",\n      alignItems: \"center\"\n    },\n    children: [_jsx(HeaderForDesktop, {\n      setMenuToggle: setMenuToggle,\n      menuToggle: menuToggle\n    }), _jsxs(ScrollView, {\n      style: {\n        margin: 10,\n        width: \"80%\",\n        padding: 50\n      },\n      children: [_jsxs(View, {\n        children: [_jsx(Text, {\n          style: {\n            marginTop: 10\n          },\n          children: \"Upload images [Max 5 photos]\"\n        }), _jsxs(View, {\n          style: {\n            flex: 1,\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          },\n          children: [_jsx(Button, {\n            title: \"Pick an image from camera roll\",\n            onPress: pickImage\n          }), image && _jsx(Image, {\n            source: {\n              uri: image\n            },\n            style: {\n              width: 200,\n              height: 200\n            }\n          })]\n        }), _jsx(Pressable, {\n          style: {\n            backgroundColor: colors.white,\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            marginVertical: 20,\n            height: 150,\n            width: 150,\n            borderWidth: 1,\n            borderStyle: \"dashed\",\n            borderRadius: 30\n          },\n          onPress: function onPress() {\n            navigation.navigate(\"SelectPhoto\");\n          },\n          children: _jsx(AntDesign, {\n            name: \"pluscircle\",\n            size: 24,\n            color: \"black\"\n          })\n        }), _jsx(View, {\n          children: _jsx(ScrollView, {\n            horizontal: true,\n            children: imageData && imageData.map(function (component, index) {\n              return _jsx(Image, {\n                source: {\n                  uri: component.uri\n                },\n                style: {\n                  height: 100,\n                  width: 100,\n                  marginBottom: 20,\n                  marginTop: -5,\n                  marginRight: 5\n                }\n              }, component.id);\n            })\n          })\n        })]\n      }), _jsxs(Pressable, {\n        style: styles.catStyle,\n        onPress: function onPress() {\n          navigation.navigate(\"SelectCategory\");\n        },\n        children: [_jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          },\n          children: [_jsx(Octicons, {\n            name: \"settings\",\n            size: 24,\n            color: \"black\"\n          }), _jsx(Text, {\n            style: {\n              fontSize: 16,\n              color: colors.secondary,\n              marginLeft: 5\n            },\n            children: category.catName\n          })]\n        }), _jsx(AntDesign, {\n          name: \"right\",\n          size: 22,\n          color: colors.secondary\n        })]\n      }), _jsxs(Pressable, {\n        onPress: function onPress() {\n          navigation.navigate(\"SelectLocation\");\n        },\n        style: styles.catStyle,\n        children: [_jsxs(View, {\n          style: {\n            flexDirection: \"row\",\n            alignItems: \"center\"\n          },\n          children: [_jsx(MaterialCommunityIcons, {\n            name: \"map-marker\",\n            size: 24,\n            color: colors.secondary\n          }), _jsx(Text, {\n            style: {\n              fontSize: 16,\n              color: colors.secondary,\n              marginLeft: 5\n            },\n            children: Location.locName\n          })]\n        }), _jsx(AntDesign, {\n          name: \"right\",\n          size: 22,\n          color: colors.secondary\n        })]\n      }), _jsxs(View, {\n        style: styles.inputTextStyle,\n        children: [_jsx(MaterialIcons, {\n          name: \"title\",\n          size: 24,\n          color: colors.secondary\n        }), _jsx(TextInput, {\n          placeholder: \"Adv Title\",\n          style: {\n            width: \"100%\"\n          },\n          onChangeText: function onChangeText(text) {\n            return setTitle(text);\n          }\n        })]\n      }), _jsxs(View, {\n        style: styles.inputTextStyle,\n        children: [_jsx(MaterialIcons, {\n          name: \"description\",\n          size: 24,\n          color: colors.secondary\n        }), _jsx(TextInput, {\n          placeholder: \"Write a description\",\n          style: {\n            marginLeft: 5,\n            width: \"100%\"\n          },\n          onChangeText: function onChangeText(text) {\n            return setDescription(text);\n          },\n          multiline: true,\n          numberOfLines: 3\n        })]\n      }), _jsxs(View, {\n        style: [styles.inputTextStyle, {\n          width: \"50%\"\n        }],\n        children: [_jsx(FontAwesome, {\n          name: \"dollar\",\n          size: 24,\n          color: colors.secondary\n        }), _jsx(TextInput, {\n          placeholder: \"Add a value\",\n          style: {\n            marginLeft: 5,\n            width: \"100%\"\n          },\n          onChangeText: function onChangeText(text) {\n            return setRentValue(text);\n          },\n          keyboardType: \"numeric\"\n        })]\n      }), _jsx(Pressable, {\n        onPress: function onPress() {\n          return storeToDB();\n        },\n        android_ripple: {\n          color: \"grey\"\n        },\n        style: {\n          margin: 10,\n          borderRadius: 30,\n          backgroundColor: colors.secondary,\n          alignItems: \"center\",\n          paddingLeft: 20,\n          elevation: 5,\n          marginBottom: 50\n        },\n        children: _jsx(Text, {\n          style: {\n            color: colors.white,\n            paddingVertical: 12,\n            fontSize: 14.5,\n            fontWeight: \"bold\"\n          },\n          children: postProcessing ? \"Processing...\" : \"POST ADV\"\n        })\n      })]\n    }), _jsx(MenuDetailsForDesktop, {\n      menuToggle: menuToggle,\n      top: 59,\n      right: \"9.3%\"\n    })]\n  });\n};\n\nexport default withAuthenticator(Listing);","map":{"version":3,"sources":["C:/Users/Km Habib/Documents/GitHub/Rent_Project/rent/src/screens/Listing/index.js"],"names":["React","useState","useEffect","styles","withAuthenticator","Auth","Storage","API","graphqlOperation","AntDesign","colors","Octicons","MaterialCommunityIcons","MaterialIcons","FontAwesome","useNavigation","useRoute","v4","uuidv4","createListing","HeaderForDesktop","MenuDetailsForDesktop","ImagePicker","Listing","navigation","imageData","setImageData","catID","catName","category","setCategory","locID","locName","Location","setLocation","title","setTitle","description","setDescription","rentValue","setRentValue","userID","setUserID","userEmail","setUserEmail","postSuccess","setPostSuccess","postProcessing","setPostProcessing","image","setImage","pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","allowsMultipleSelection","result","console","log","cancelled","selected","uri","Alert","alert","text","onPress","navigate","screen","currentAuthenticatedUser","then","user","attributes","sub","email","catch","err","route","params","undefined","imageAllUrl","storeToDB","map","compnent","index","imageUrl","fetch","response","blob","JSON","stringify","urlParts","split","extension","length","key","push","imageUri","postData","categoryName","categoryID","images","locationID","locationName","owner","commonID","menuToggle","setMenuToggle","flex","width","alignItems","margin","padding","marginTop","justifyContent","height","backgroundColor","white","display","marginVertical","borderWidth","borderStyle","borderRadius","component","marginBottom","marginRight","id","catStyle","flexDirection","fontSize","color","secondary","marginLeft","inputTextStyle","paddingLeft","elevation","paddingVertical","fontWeight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  StyleSheet,\n  SafeAreaView,\n  Platform,\n  View,\n  Text,\n  Pressable,\n  TextInput,\n  Image,\n  ScrollView,\n  Alert,\n  Button,\n} from \"react-native\";\nimport styles from \"./styles\";\nimport { withAuthenticator } from \"aws-amplify-react-native\";\nimport { Auth, Storage, API, graphqlOperation } from \"aws-amplify\";\nimport { AntDesign } from \"@expo/vector-icons\";\nimport { colors } from \"../../modal/color\";\nimport { Octicons } from \"@expo/vector-icons\";\nimport { MaterialCommunityIcons } from \"@expo/vector-icons\";\nimport { MaterialIcons } from \"@expo/vector-icons\";\nimport { FontAwesome } from \"@expo/vector-icons\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useRoute } from \"@react-navigation/native\";\nimport \"react-native-get-random-values\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { createListing } from \"../../graphql/mutations\";\nimport HeaderForDesktop from \"../../components/headerForDesktop\";\nimport MenuDetailsForDesktop from \"../../components/menuDetailsForDesktop\";\nimport * as ImagePicker from \"expo-image-picker\";\nconst Listing = () => {\n  const navigation = useNavigation();\n  const [imageData, setImageData] = useState([]);\n  const [category, setCategory] = useState({ catID: 0, catName: \"Category\" });\n  const [Location, setLocation] = useState({ locID: 0, locName: \"Location\" });\n  const [title, setTitle] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [rentValue, setRentValue] = useState(\"\");\n  const [userID, setUserID] = useState(\"\");\n  const [userEmail, setUserEmail] = useState(\"\");\n  const [postSuccess, setPostSuccess] = useState(\"\");\n  const [postProcessing, setPostProcessing] = useState(false);\n\n  const [image, setImage] = useState(null);\n\n  const pickImage = async () => {\n    // No permissions request is necessary for launching the image library\n    let result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\n      allowsEditing: true,\n      aspect: [4, 3],\n      quality: 1,\n      allowsMultipleSelection: true,\n    });\n\n    console.log(\"expo images: \", result);\n\n    if (!result.cancelled) {\n      // setImage(result.uri);\n      console.log(result.selected[0].uri);\n    }\n  };\n\n  useEffect(() => {\n    if (postSuccess !== \"\") {\n      setPostProcessing(false);\n      Alert.alert(\"Success\", postSuccess, [\n        {\n          text: \"Ok\",\n          onPress: () => navigation.navigate(\"Home\", { screen: \"Explore\" }),\n        },\n      ]);\n    }\n  }, [postSuccess]);\n  Auth.currentAuthenticatedUser()\n    .then((user) => {\n      console.log(\"user id is: \", user.attributes.sub);\n      setUserID(user.attributes.sub);\n      setUserEmail(user.attributes.email);\n    })\n    .catch((err) => {\n      console.log(err);\n      throw err;\n    });\n\n  const route = useRoute();\n  useEffect(() => {\n    if (!route.params) {\n      console.log(\"There is no data in route\");\n    } else {\n      if (route.params.imageData !== undefined) {\n        // console.log(route.params.imageData);\n        setImageData(route.params.imageData);\n      } else if (route.params.catID !== undefined) {\n        setCategory(route.params);\n      } else if (route.params.locID !== undefined) {\n        setLocation(route.params);\n      }\n    }\n  });\n\n  const imageAllUrl = [];\n  const storeToDB = async () => {\n    setPostProcessing(true);\n    imageData &&\n      imageData.map(async (compnent, index) => {\n        const imageUrl = compnent.uri;\n        const response = await fetch(imageUrl);\n        const blob = await response.blob();\n        console.log(\"image blob is: \", JSON.stringify(response));\n        const urlParts = imageUrl.split(\".\");\n        const extension = urlParts[urlParts.length - 1];\n        const key = `${uuidv4()}.${extension}`;\n        imageAllUrl.push({ imageUri: key });\n        // await Storage.put(key, blob);\n        // alert(blob);\n\n        if (imageData.length == index + 1) {\n          const postData = {\n            title: title,\n            categoryName: category.catName,\n            categoryID: category.catID,\n            description: description,\n            images: JSON.stringify(imageAllUrl),\n            locationID: Location.locID,\n            locationName: Location.locName,\n            owner: userEmail,\n            rentValue: rentValue,\n            userID: userID,\n            commonID: \"1\",\n          };\n\n          // await API.graphql({\n          // query: createListing,\n          // variables: { input: postData },\n          // authMode: \"AMAZON_COGNITO_USER_POOLS\",\n          // });\n\n          // setPostProcessing(false);\n          // setPostSuccess(\"Your adv have successfully published.\");\n        }\n      });\n  };\n  // Auth.signOut();\n  const [menuToggle, setMenuToggle] = useState(false);\n  return (\n    <View style={{ flex: 1, width: \"100%\", alignItems: \"center\" }}>\n      <HeaderForDesktop setMenuToggle={setMenuToggle} menuToggle={menuToggle} />\n      <ScrollView style={{ margin: 10, width: \"80%\", padding: 50 }}>\n        <View>\n          <Text style={{ marginTop: 10 }}>Upload images [Max 5 photos]</Text>\n          <View\n            style={{\n              flex: 1,\n              alignItems: \"center\",\n              justifyContent: \"center\",\n            }}>\n            <Button\n              title=\"Pick an image from camera roll\"\n              onPress={pickImage}\n            />\n            {image && (\n              <Image\n                source={{ uri: image }}\n                style={{ width: 200, height: 200 }}\n              />\n            )}\n          </View>\n          <Pressable\n            style={{\n              backgroundColor: colors.white,\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              marginVertical: 20,\n              height: 150,\n              width: 150,\n              borderWidth: 1,\n              borderStyle: \"dashed\",\n              borderRadius: 30,\n            }}\n            onPress={() => {\n              navigation.navigate(\"SelectPhoto\");\n            }}>\n            <AntDesign name=\"pluscircle\" size={24} color=\"black\" />\n          </Pressable>\n          <View>\n            <ScrollView horizontal={true}>\n              {imageData &&\n                imageData.map((component, index) => (\n                  <Image\n                    key={component.id}\n                    source={{ uri: component.uri }}\n                    style={{\n                      height: 100,\n                      width: 100,\n                      marginBottom: 20,\n                      marginTop: -5,\n                      marginRight: 5,\n                    }}\n                  />\n                ))}\n            </ScrollView>\n          </View>\n        </View>\n        <Pressable\n          style={styles.catStyle}\n          onPress={() => {\n            navigation.navigate(\"SelectCategory\");\n          }}>\n          <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\n            <Octicons name=\"settings\" size={24} color=\"black\" />\n            <Text\n              style={{ fontSize: 16, color: colors.secondary, marginLeft: 5 }}>\n              {category.catName}\n            </Text>\n          </View>\n          <AntDesign name=\"right\" size={22} color={colors.secondary} />\n        </Pressable>\n        <Pressable\n          onPress={() => {\n            navigation.navigate(\"SelectLocation\");\n          }}\n          style={styles.catStyle}>\n          <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\n            <MaterialCommunityIcons\n              name=\"map-marker\"\n              size={24}\n              color={colors.secondary}\n            />\n            <Text\n              style={{ fontSize: 16, color: colors.secondary, marginLeft: 5 }}>\n              {Location.locName}\n            </Text>\n          </View>\n          <AntDesign name=\"right\" size={22} color={colors.secondary} />\n        </Pressable>\n\n        <View style={styles.inputTextStyle}>\n          <MaterialIcons name=\"title\" size={24} color={colors.secondary} />\n          <TextInput\n            placeholder=\"Adv Title\"\n            style={{ width: \"100%\" }}\n            onChangeText={(text) => setTitle(text)}\n          />\n        </View>\n        <View style={styles.inputTextStyle}>\n          <MaterialIcons\n            name=\"description\"\n            size={24}\n            color={colors.secondary}\n          />\n          <TextInput\n            placeholder=\"Write a description\"\n            style={{ marginLeft: 5, width: \"100%\" }}\n            onChangeText={(text) => setDescription(text)}\n            multiline={true}\n            numberOfLines={3}\n          />\n        </View>\n        <View style={[styles.inputTextStyle, { width: \"50%\" }]}>\n          <FontAwesome name=\"dollar\" size={24} color={colors.secondary} />\n          <TextInput\n            placeholder=\"Add a value\"\n            style={{ marginLeft: 5, width: \"100%\" }}\n            onChangeText={(text) => setRentValue(text)}\n            keyboardType=\"numeric\"\n          />\n        </View>\n        <Pressable\n          onPress={() => storeToDB()}\n          android_ripple={{ color: \"grey\" }}\n          style={{\n            margin: 10,\n            borderRadius: 30,\n            backgroundColor: colors.secondary,\n            alignItems: \"center\",\n            paddingLeft: 20,\n            // marginTop: 150,\n            elevation: 5,\n            marginBottom: 50,\n          }}>\n          <Text\n            style={{\n              color: colors.white,\n              paddingVertical: 12,\n              fontSize: 14.5,\n              fontWeight: \"bold\",\n            }}>\n            {postProcessing ? \"Processing...\" : \"POST ADV\"}\n          </Text>\n        </Pressable>\n      </ScrollView>\n      <MenuDetailsForDesktop menuToggle={menuToggle} top={59} right={\"9.3%\"} />\n    </View>\n  );\n};\n\nexport default withAuthenticator(Listing);\n"]},"metadata":{},"sourceType":"module"}